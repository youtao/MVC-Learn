$(function(){var n={editingId:undefined};$("#menu-list").treegrid({url:"/admin/menu/getmenu",idField:"Id",treeField:"Title",method:"GET",loadMsg:"拼命加载中...",rownumbers:!0,animate:!0,lines:!0,columns:[[{field:"Title",title:"title",width:"30%",editor:"text"},{field:"Url",title:"url",width:"40%",editor:"text"},{field:"Icon",title:"icon",width:"20%",align:"center",editor:"text",formatter:function(n){return'<i class="'+n+'"><\/i>&nbsp;&nbsp;&nbsp;'+n}}]],toolbar:[{text:"添加",iconCls:"fa fa-create",handler:function(){}},"-",{text:"编辑",iconCls:"fa fa-edit",handler:function(){if(n.editingId!=undefined){$("#menu-list").treegrid("select",n.editingId);return}var t=$("#menu-list").treegrid("getSelected");t&&(n.editingId=t.Id,$("#menu-list").treegrid("beginEdit",n.editingId))}},"-",{text:"保存",iconCls:"fa fa-save",handler:function(){if(n.editingId!=undefined){var t=$("#tg");$("#menu-list").treegrid("endEdit",n.editingId);n.editingId=undefined}}},"-",{text:"取消",iconCls:"fa fa-user",handler:function(){n.editingId!=undefined&&($("#menu-list").treegrid("cancelEdit",n.editingId),n.editingId=undefined)}}],loadFilter:function(n){for(var t=0;t<n.length;t++)n[t].HasChildren&&(n[t].state="closed",n[t].children=[]);return n},onBeforeExpand:function(n){$("#menu-list").treegrid("options").url="/admin/menu/getmenu?ParentId="+n.Id},onAfterEdit:function(n){$.post("/admin/menu/edit",{Id:n.Id,Title:n.Title,Url:n.Url,Icon:n.Icon},function(n){console.log(n)})}})});