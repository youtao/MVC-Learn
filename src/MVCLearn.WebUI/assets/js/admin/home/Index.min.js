function iframeOnLoad(){var t=_page.lastLoadIframeTime,i,n,r,u;t<0||(i=new Date,n=i.getTime()-t,n=(n/1e3).toFixed(2),r=moment().format("L"),u="页面加载完成(耗时:"+n+"s)",window.toastr.success(u,r,{closeButton:!0,positionClass:"toast-top-right",timeOut:"5000"}),_page.lastLoadIframeTime=-1)}$(function(){_page.init()});var _page={iframeSrc:"",lastLoadIframeTime:-1,init:function(){var n=this;$(window).resize(function(){n.onresize()});n.initMenu();n.loadIframe(GlobalConfig.Iframe);n.initNotification();n.documentOnClick()},initMenu:function(){var n=this;$.ajax({url:GlobalConfig.WebApi+"Privilege/GetMenus",type:"GET",dataType:"json",xhrFields:{withCredentials:!0},crossdomain:!0,success:function(t){var i=n.recursiveMenu(t.data),r=i.substr(0,3),u=i.substring(3,i.length);i=r+' id="menu-main" class="menu-main" '+u;$("#menu-inner").append(i).perfectScrollbar();n.menuListener()}})},recursiveMenu:function(n,t){var f,u,s,e;for(t||(t=0),f="<ul>",u=0;u<n.length;u++){var r=n[u],i="<li>",o="";if(t>=1&&(s=30+(t-1)*25,o=' style="padding-left:'+s+'px;" '),i+='<a href="javascript:void(0);"'+o+'data-url="'+r.url+'">',e="fa fa-sitemap",r.icon&&(e=r.icon),i+='<span class="'+e+' menu-icon"><\/span> ',i+='<span class="menu-title">'+r.title+"<\/span>",i+="<\/a>",r.children.length>0){var h=i.substr(0,3),c=i.substring(3,i.length);i=h+' class="has-sub" '+c+arguments.callee(r.children,t+1)}i+="<\/li>";f+=i}return f+"<\/ul>"},menuListener:function(){var n=this;$("#left-menu").on("click","a",function(){var i=$(this),t=i.parent(),r;t.hasClass("has-sub")?t.hasClass("expanded")?n.collapseMenu(t):n.expandMenu(t):(n.collapseMenu(t.siblings(".expanded")),r=i.attr("data-url"),r!=="javascript:void(0);"&&(n.loadIframe(r),$("#left-menu a.active").removeClass("active"),i.addClass("active")))})},expandMenu:function(n){var t,i;n.addClass("expanded");this.collapseMenu(n.siblings(".expanded"));t=n.children("ul");t.css("display","block");i=t.outerHeight();t.css("height",0);t.animate({height:i},200,function(){t.css("height","");$("#menu-inner").perfectScrollbar("update")})},collapseMenu:function(n){n.removeClass("expanded");var t=n.children("ul");t.css("height",t.outerHeight());t.animate({height:0},200,function(){t.css("height","");n.find("ul").css("display","none");n.find("li").removeClass("expanded");$("#menu-inner").perfectScrollbar("update")})},loadIframe:function(n){if(n){this.onresize();this.lastLoadIframeTime=(new Date).getTime();n+="?from=iframe";var t='<iframe src="'+n+'" onload="iframeOnLoad();"><\/iframe>';$("#page-iframe").html(t);this.iframeSrc=n}},onresize:function(){var n=$(window).height(),t=$("#page-heard"),i=$("#page-iframe");n=n-t.outerHeight();i.css("height",n)},initNotification:function(){$("#page-heard ul.nav-menu > li.item").click(function(){$(this).siblings().removeClass("open");$(this).hasClass("open")?$(this).removeClass("open"):$(this).addClass("open")});$("#page-heard ul.messages").perfectScrollbar()},documentOnClick:function(){$(document).click(function(n){var t=$(n.target).isChildAndSelfOf("#page-heard ul.nav-menu > li.item");t||$("#page-heard ul.nav-menu > li.item").removeClass("open")})}};